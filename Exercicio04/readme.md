# Exercício 04

## Uso do EMR em Nuvem

### EMR no EC2 com configurações e Steps definidos:

![image](https://user-images.githubusercontent.com/108779870/182524534-23a32f27-2dd0-4ab4-b201-7d04b6a65fb7.png)
![image](https://user-images.githubusercontent.com/108779870/182524547-f339aeef-70bf-4745-bb7e-610d7e30b8c7.png)
![image](https://user-images.githubusercontent.com/108779870/182524564-100ce2a6-bb66-447e-a4c4-66bb6ff58e1d.png)
![image](https://user-images.githubusercontent.com/108779870/182524594-15514bb3-129d-4ede-8de0-93c0b8916cb9.png)
![image](https://user-images.githubusercontent.com/108779870/182524617-cdc0e47b-d492-46fd-bf2c-1de8ecc17b99.png)
![image](https://user-images.githubusercontent.com/108779870/182524633-ca167a26-be49-4e6d-85a6-8ab907e44915.png)
![image](https://user-images.githubusercontent.com/108779870/182524654-05f0a3be-ddf1-41ee-b38c-f0c99ff2ad86.png)
![image](https://user-images.githubusercontent.com/108779870/182524671-4cc8845d-c3b7-47cf-9880-b06d8632ef82.png)
![image](https://user-images.githubusercontent.com/108779870/182524711-ab4eade7-3921-44ba-b894-274465aff6d7.png)

## Bucket no S3 com scripts, camadas e arquivo de Bootstrap

### Scripts e arquivo Bootstrap:

![image](https://user-images.githubusercontent.com/108779870/182524751-611dbaef-eba7-4c81-96b4-29fe33be2448.png)
![image](https://user-images.githubusercontent.com/108779870/182524776-5d955c64-a586-406a-a13d-819bfa7f6407.png)
![image](https://user-images.githubusercontent.com/108779870/182524910-abfd9a39-ef23-4a26-9e78-7655b86932f0.png)

### Camada Raw:

![image](https://user-images.githubusercontent.com/108779870/182524826-132b1618-5388-446e-a838-261b8d3c9e01.png)
![image](https://user-images.githubusercontent.com/108779870/182524855-51920804-6ddc-4c03-8b2f-f9c5d5e80838.png)
![image](https://user-images.githubusercontent.com/108779870/182524875-fdd38653-3678-4750-91ea-8da63aec4bea.png)

### Arquivos de saída com divisões de camadas Trusted e Analytics + lista de CNPJs:

![image](https://user-images.githubusercontent.com/108779870/182525079-95467ab2-a969-4944-a7de-d81a21fd5e87.png)

### Arquivo de lista de CNPJs:

![image](https://user-images.githubusercontent.com/108779870/182525162-283bc82c-62bf-434c-bf47-a3924470ca8a.png)

### Camada Trusted:

![image](https://user-images.githubusercontent.com/108779870/182525194-a1ad1589-4d71-4765-88cb-85ef030b7765.png)
![image](https://user-images.githubusercontent.com/108779870/182525215-77bd9ecf-1b1b-4650-84e2-0380a03f4caa.png)
![image](https://user-images.githubusercontent.com/108779870/182525228-dc1261d7-2acf-4957-af96-e519116bb9b9.png)

### Camada Analytics:

![image](https://user-images.githubusercontent.com/108779870/182525251-68645a50-07b5-46da-b01d-63ad9e685d00.png)
![image](https://user-images.githubusercontent.com/108779870/182525296-3f322158-c58a-4b0f-a0d6-7ab932a42d16.png)
![image](https://user-images.githubusercontent.com/108779870/182525316-3a98bc76-6aa9-431f-a178-668ed155f75c.png)

## AWS Glue Data Catalog

### Data Catalog para mapeamento de tabelas e database:

![image](https://user-images.githubusercontent.com/108779870/182525595-2ebc4b31-76c5-4bf2-a2fd-1b655c309708.png)
![image](https://user-images.githubusercontent.com/108779870/182525524-55e6266f-d8a2-4ba2-a6f5-8a4fc5f6b4ec.png)

### Tabela stage para csvs:

![image](https://user-images.githubusercontent.com/108779870/182525689-ce52298b-5ab8-42f2-8fd3-efc6361fdf1b.png)
![image](https://user-images.githubusercontent.com/108779870/182525709-e0fa0712-fcee-472f-b751-8be5510ca814.png)

### Tabela stage para api:

![image](https://user-images.githubusercontent.com/108779870/182526205-daeb4414-1f83-4b6f-b580-cd4ba8f0bf60.png)
![image](https://user-images.githubusercontent.com/108779870/182526247-02d1d634-d3e5-4037-9d86-efdca81eb5af.png)

### Tabela Fato1:

![image](https://user-images.githubusercontent.com/108779870/182525631-c9a6c6dc-3d86-4923-bc8d-5d7dbf783bfa.png)
![image](https://user-images.githubusercontent.com/108779870/182525646-a123388d-50e1-4828-9533-916110fdc5c5.png)

### Tabela Fato2:

![image](https://user-images.githubusercontent.com/108779870/182526032-09a82e41-8b5c-4949-8a3b-63946583dbb3.png)
![image](https://user-images.githubusercontent.com/108779870/182526051-d29f498a-c281-4045-b733-8ab478596fe6.png)

## Visualização no Tableau

### Relacionamento entre tabelas:

![image](https://user-images.githubusercontent.com/108779870/182526400-ad74df11-ba3a-4541-8fa9-20291f0eb628.png)

### Gráficos:

![image](https://user-images.githubusercontent.com/108779870/182525368-8a611401-2f08-48db-8d6f-f5358dbfd3c4.png)
![image](https://user-images.githubusercontent.com/108779870/182525382-13b8cc06-7159-4759-9568-01b9fe2c6e0e.png)
![image](https://user-images.githubusercontent.com/108779870/182525395-5973ae0b-0077-4f9a-990a-89683d1430de.png)
